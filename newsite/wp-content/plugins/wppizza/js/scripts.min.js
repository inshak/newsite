var wppizzaCartJson={},wppizzaOnCartInit=function(){},wppizzaUpdateCart=function(){},wppizzaTotalsBefore=function(){},wppizzaTotals=function(){},wppizzaRestoreOrder=function(){},wppizzaPrepareOrder=function(){},wppizzaPrettifyJsAlerts=function(){},wppizzaGatewayCss={},wppizzaGatewayJs={},wppizzaGetCheckout=function(){};jQuery(document).ready(function(l){var u="wppizza";wppizza.shopOpen=-1,void 0===wppizza.usingCache&&(wppizza.shopOpen=0<l("."+u+"-open").length);function z(e){wppizzaCartJson=0<l("#"+u+"-cart-json").length&&"empty"!==e?JSON.parse(l("#"+u+"-cart-json").val()):{}}z("ini");var n=0<l("."+u+"-cart").length||0<l("."+u+"-cart-novis").length||0<l("."+u+"-totals").length||0<l("#"+u+"-minicart").length,e=0<l("."+u+"-login-form").length,p=void 0!==wppizza.isCheckout,s=void 0!==wppizza.cfrm,c=!1,m=void 0!==wppizza.pjsa,v=void 0!==wppizza.fpt,w=!1,f="wppizza-send-order",h=!1,g="",a=void 0!==wppizza.compat&&void 0!==wppizza.compat.gwChg,t=void 0!==wppizza.compat&&void 0!==wppizza.compat.gwInit,o=0;l(document).ajaxStart(function(){o++});var r=0;l(document).ajaxStop(function(){0==r&&R("complete"),c||b()}),l(document).ajaxComplete(function(e,t,i){D()}),l(document).ajaxError(function(e,t,i,a){console.log("error :"),console.log(a),console.log(i),console.log(t.responseText),b()}),l(document).ajaxStop(function(){w&&(E(wppizza.funcCartRefr,w),w=!1)}),wppizzaPrettifyJsAlerts=function(e,t){var i=(i=(new DOMParser).parseFromString(wppizza.pjsa.h1,"text/html")).documentElement.textContent,a=wppizza.pjsa.ok;d=document,d.getElementById("wppizzaJsAlert")||(mObj=d.getElementsByTagName("body")[0].appendChild(d.createElement("div")),mObj.id="wppizzaJsAlert",mObj.style.height=d.documentElement.scrollHeight+"px",alertObj=mObj.appendChild(d.createElement("div")),alertObj.id="wppizzaAlertBox",d.all&&!window.opera&&(alertObj.style.top=document.documentElement.scrollTop+"px"),alertObj.style.left=(d.documentElement.scrollWidth-alertObj.offsetWidth)/2+"px",alertObj.style.visiblity="visible",h1=alertObj.appendChild(d.createElement("div")),h1.id="wppizzaAlertTitle",h1.appendChild(d.createTextNode(i)),msg=alertObj.appendChild(d.createElement("p")),msg.innerHTML=e,btn_wrap=alertObj.appendChild(d.createElement("div")),btn_wrap.id="btnWrap",btn_ok=btn_wrap.appendChild(d.createElement("button")),btn_ok.id="wppizzaAlertOk",btn_ok.innerHTML=a,btn_ok.onclick=function(){return y(!0),!1},alertObj.style.display="block")};var y=function(e){document.getElementsByTagName("body")[0].removeChild(document.getElementById("wppizzaJsAlert"))};wppizzaRestoreOrder=function(){b(),l("."+u+"-ordernow, #"+u+"-ordernow").attr("disabled",!1)};function _(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),p?e||(l("html").css({position:"relative"}),l("body").prepend('<div class="wppizza-loading"></div>'),l("."+u+"-ordernow").attr("disabled","true")):e&&t?e.prepend('<div class="'+t+'"></div>'):l("."+u+"-cart").prepend('<div class="wppizza-loading"></div>')}function j(e){if(void 0!==e&&!1!==e)return a=e.toLowerCase();var t=l('input[type="hidden"][name="wppizza_gateway_selected"]'),i=l('input[type="radio"][name="wppizza_gateway_selected"]:checked'),e=l('select[name="wppizza_gateway_selected"] option:selected'),a="";return 0<t.length?a=t.val().toLowerCase():0<i.length?a=i.val().toLowerCase():0<e.length&&(a=e.val().toLowerCase()),a}function k(){return-1!==wppizza.shopOpen&&(!(!wppizza.shopOpen&&n)||(m?wppizzaPrettifyJsAlerts(wppizza.msg.closed,"alert"):alert(wppizza.msg.closed),!1))}var b=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),e&&t?e.find("."+t).remove():0<(t=l("."+u+"-loading")).length&&l.each(t,function(e,t){l(this).remove()})},g=j(!(wppizzaPrepareOrder=function(e){var t=l("#"+u+"-send-order").serialize();jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"prepareorder",gateway_selected:e,data:t}},function(e){if(void 0!==e.error){var i=[],a=[];l.each(e.error,function(e,t){i[e]=t.error_id,a[e]=t.error_message});e="ERROR: "+i.join("|")+"\n";return e+=""+a.join("\n"),void(m?wppizzaPrettifyJsAlerts(e,"alert"):alert(e))}w=!1},"json")}));if(p&&window.performance&&2===window.performance.navigation.type)return _(),void window.location.reload(!0);wppizzaUpdateCart=function(e){if(_(),void 0!==e&&void 0!==e.markup&&void 0!==e.is_open&&void 0!==e.cart)return O(e.markup),wppizza.shopOpen=e.is_open,void(w=e.cart);jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"loadcart",isCheckout:p}},function(e){O(e.markup),wppizza.shopOpen=e.is_open,w=e.cart,z("loadcart")},"json")};function C(e){"refresh"==e&&_(),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"loadcart",isCheckout:p}},function(e){O(e.markup),wppizza.shopOpen=e.is_open,w=e.cart,z("update_cart"),$(e,"debug3")},"json")}var O=function(o){var e=l("."+u+"-cart");l.each(e,function(e,t){var i=l(this).attr("id"),a=i.split("-").pop(-1);a<=0||""==a?l(this).html(o):(l(this).html(o),l("#"+i+" ."+u+"-order-itemised > tbody").css({height:a+"px","min-height":a+"px","max-height":a+"px"}))})};n&&(void 0!==wppizza.usingCache&&C("load"),l(document).on("click","."+u+"-cart-refresh",function(e){C("refresh")}));function x(e,t){if(0<e.length)for(i=0;i<e.length;i++)new Function("term","return "+e[i]+"(term);")(t)}var T,E=function(e,t){if(0<e.length)for(i=0;i<e.length;i++)new Function("term","return "+e[i]+"(term);")(t);R("refresh"),r++};0<l("."+u+"-totals-container").length&&(Q=l("."+u+"-totals-viewcart, ."+u+"-totals-viewcart-button"),T=l("."+u+"-totals-cart"),0<Q.length&&(l(document).on("click","."+u+"-totals-container>.dashicons-cart, ."+u+"-totals-viewcart-button",function(e){l(this).closest("div").find("."+u+"-totals-cart").fadeToggle()}),l("html").click(function(e){e=l(e.target);if(!e.is("#"+u+"-minicart .ui-spinner-input, #"+u+"-minicart .ui-spinner-button, #"+u+"-minicart .ui-icon")){if(e.is("."+u+"-totals-container>.dashicons-cart, ."+u+"-totals-viewcart-button>input"))if(e.closest("div").find("."+u+"-totals-cart").is(":visible"))return;T.is(":visible")&&T.fadeOut()}})),(wppizzaTotalsBefore=function(e){void 0===e&&(e=!1);var t=l("."+u+"-totals-container");!0!==e&&_(t,"wppizza-loading-small")})(!0),(wppizzaTotals=function(e){void 0===e&&(e=!1);var t=l("."+u+"-totals-container"),i=l("."+u+"-totals-order"),a=l("."+u+"-totals-items"),r=l("."+u+"-totals-itemcount"),n=l("."+u+"-totals-checkout-button"),p=l("."+u+"-totals-viewcart"),s=l("."+u+"-totals-viewcart-button"),c=l("."+u+"-totals-emptycart-button"),d=l("."+u+"-totals-cart");l("."+u+"-totals-cart-items"),l("."+u+"-totals-cart-summary");jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"gettotals"}},function(o){J.length<=0&&0<A.length&&(void 0!==o.get_cart_json?0<l("#"+u+"-minicart > #"+u+"-cart-json").length?(l("#"+u+"-minicart > #"+u+"-cart-json").replaceWith(o.get_cart_json),z("minicart-update")):(A.prepend(o.get_cart_json),z("minicart-ini")):(l("#"+u+"-minicart > #"+u+"-cart-json").empty().remove(),z("minicart-empty"))),0<o.no_of_items?(t.removeClass("wppizza-totals-no-items"),t.addClass("wppizza-totals-has-items")):(t.removeClass("wppizza-totals-has-items"),t.addClass("wppizza-totals-no-items")),0<d.length&&0<p.length&&(p.hasClass("dashicons-cart")||p.addClass("dashicons dashicons-cart"),""!=o.cart_empty?p.hide():p.show()),o.is_open&&(wppizza.shopOpen=!0),0<s.length&&s.html(o.view_cart_button),0<i.length&&i.html(o.total),0<a.length&&a.html(o.total_price_items),0<r.length&&r.html(o.itemcount),0<n.length&&n.html(o.checkout_button),0<r.length&&c.html(o.emptycart_button),0<d.length&&l.each(d,function(e,t){var i=l(this),a="";i.hasClass("wppizza-totals-cart-items")&&(a+=o.items),i.hasClass("wppizza-totals-cart-summary")&&(a+=o.summary),void 0!==o.minimum_order&&(a+=o.minimum_order),i.html(a),h&&R("minicart-cart_markup")}),!0!==e&&b(t,"wppizza-loading-small"),h=!(w=!1)},"json")})(!0));var P,A=l("#"+u+"-minicart"),J=l("."+u+"-cart");0<A.length&&(function(){void 0!==wppizza.crt.mElm&&A.prependTo(""+wppizza.crt.mElm);var e,t,i,a,o=wppizza.crt.mCartPadTop;void 0!==wppizza.crt.mPadTop&&0<wppizza.crt.mPadTop&&(o=wppizza.crt.mPadTop,(e=void 0!==wppizza.crt.mPadElm?l(""+wppizza.crt.mPadElm):l("body")).css({"padding-top":"+="+wppizza.crt.mPadTop+"px"})),void 0===wppizza.crt.mStatic&&(t=l(window),i=!0,setTimeout(function(){P(t,A,J,o,e),i=!1},500),t.scroll(function(){i||(clearTimeout(a),a=setTimeout(function(){P(t,A,J,o,e)},300))}),t.resize(function(){i||(clearTimeout(a),a=setTimeout(function(){P(t,A,J,o,e)},300))}))}(),P=function(e,t,i,a,o){var r,n,p=e.width();void 0!==wppizza.crt.mMaxWidth&&(r=wppizza.crt.mMaxWidth),void 0!==r&&r<p||void 0!==wppizza.isCheckout?t.is(":visible")&&t.fadeOut(250):((n=!(0<i.length)||(e=(p=e.scrollTop())+e.height(),(n=i.offset().top)+i.height()<=p||e<=n))&&t.is(":hidden")&&(void 0!==o&&o.animate({"padding-top":"+="+a+"px"},250),t.fadeIn(250)),!n&&t.is(":visible")&&(void 0!==o&&o.animate({"padding-top":"-="+a+"px"},250),t.fadeOut(250)))}),l(document).on("click","."+u+"-reorder-purchase",function(e){var t;e.preventDefault(),e.stopPropagation(),k()&&n&&(_(),t=l(this).attr("id"),x(wppizza.funcBeforeCartRefr,e),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"reorder",id:t,isCheckout:p}},function(e){void 0!==e.invalid&&console.log(e.invalid),void 0!==e.markup&&O(e.markup),w=e.cart,z("update_cart")},"json"))}),l(document).on("click","."+u+"-add-to-cart, ."+u+"-add-to-cart-select",function(e){var t,i,a,o,r;return e.preventDefault(),e.stopPropagation(),!!k()&&void(n&&(_(),r=(t=l(this)).attr("id"),void 0===wppizza.itm||void 0===wppizza.itm.fbatc||t.hasClass("wppizza-add-to-cart-btn")||(i=!0,a=t.html(),(o=t).hasClass("wppizza-do-reorder")&&(o=t.closest("td"),a=o.html(),i=!1),i&&t.removeClass("wppizza-add-to-cart"),t.fadeOut(100,function(){o.html('<div class="wppizza-item-added-feedback">'+wppizza.itm.fbatc+"</div>").fadeIn(400).delay(wppizza.itm.fbatcms).fadeOut(400,function(){o.html(a).fadeIn(100),i&&t.addClass("wppizza-add-to-cart")})})),t.hasClass("wppizza-add-to-cart-select")&&(r=r.split("_").pop(-1)+"-"+t.closest("span").find("select").val()),x(wppizza.funcBeforeCartRefr,e),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"add",id:r,isCheckout:p}},function(e){void 0!==e.invalid&&console.log(e.invalid),void 0!==e.markup&&(O(e.markup),wppizza.shopOpen=e.is_open,setTimeout(k,10)),p&&void 0!==e.page_markup&&l("."+u+"-order-wrap").replaceWith(e.page_markup),w=e.cart,z("add")},"json")))}),l(document).on("click","."+u+"-remove-from-cart, ."+u+"-delete-from-cart",function(e){e.preventDefault(),e.stopPropagation(),_();var t=l(this),i=t.attr("id");i.split("-").pop(-1);t=t.hasClass("wppizza-delete-from-cart")?0:-1,x(wppizza.funcBeforeCartRefr,e),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"modify",id:i,quantity:t,isCheckout:p}},function(e){void 0!==e.invalid&&console.log(e.invalid),void 0!==e.cart_markup&&(O(e.cart_markup),wppizza.shopOpen=e.is_open,setTimeout(k,10)),p&&void 0!==e.page_markup&&(l("."+u+"-order-wrap").replaceWith(e.page_markup),b()),w=e.cart,z("modify")},"json")}),l(document).on("keyup","."+u+"-cart-mod, ."+u+"-item-qupdate",function(e){this.value=this.value.replace(/[^0-9]/g,"")});l(document).on("focus","."+u+"-cart-mod, ."+u+"-item-qupdate",function(e){this.value.replace(/[^0-9]/g,"")}),l(document).on("blur","."+u+"-cart-mod, ."+u+"-item-qupdate",function(e){this.value=this.value.replace(/[^0-9]/g,"")}),l(document).on("click","."+u+"-trigger-choose",function(e){wppizza.shopOpen&&n&&(m?wppizzaPrettifyJsAlerts(wppizza.msg.choosesize,"alert"):alert(wppizza.msg.choosesize))}),l(document).on("click","."+u+"-trigger-click",function(e){var t;wppizza.shopOpen&&n&&(t=(t=(t=this.id.split("-")).splice(2)).join("-"),target=l("#"+u+"-"+t),target.trigger("click"))}),l(document).on("click","."+u+"-empty-cart-button",function(e){e.preventDefault(),e.stopPropagation(),_(),x(wppizza.funcBeforeCartRefr,e),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"empty",isCheckout:p}},function(e){void 0!==e.invalid&&console.log(e.invalid),void 0!==e.cart_markup&&(O(e.cart_markup),wppizza.shopOpen=e.is_open,setTimeout(k,10)),p&&void 0!==e.page_markup&&l("."+u+"-order-wrap").replaceWith(e.page_markup),w=e.cart,z("empty")},"json")});function S(e,t){var i=l('input[type="checkbox"][name="wppizza-order-pickup"]'),a=l("."+u+"-toggle-pickup"),o=l("."+u+"-toggle-delivery"),r=a.closest("label"),n=o.closest("label");!0===e&&(i.attr("disabled",!0),a.attr("disabled",!0),o.attr("disabled",!0)),!1===e&&(i.attr("disabled",!1),a.attr("disabled",!1),o.attr("disabled",!1)),!0===t&&(i.prop("checked",!1),a.prop("checked",!0),o.prop("checked",!1),r.addClass("wppizza-pickup-toggle-selected"),n.removeClass("wppizza-pickup-toggle-selected")),!1===t&&(i.prop("checked",!0),a.prop("checked",!1),o.prop("checked",!0),r.removeClass("wppizza-pickup-toggle-selected"),n.addClass("wppizza-pickup-toggle-selected"))}l(document).on("change","."+u+"-order-pickup",function(e){if(!v&&!k()){var t=l(this),i=t.attr("type"),a=t.val();return"checkbox"==i&&l("."+u+"-order-pickup").each(function(){l(this).checked=!l(this).checked}),void("radio"==i&&l("."+u+"-order-pickup").each(function(){var e=l(this);e.val()!=a&&e.prop("checked",!0)}))}if(n||v){var o,r=l(this),t=l("#"+u+"-send-order").serialize(),i=void 0!==wppizza.opt&&void 0!==wppizza.opt.puDef;r.is(":radio")?o=1==r.val():(o=!!r.is(":checked"),i&&(o=!r.is(":checked")));r=i!==o?!0:!1;if(S(!0,null),S(null,!!o),void 0!==wppizza.opt&&void 0!==wppizza.opt.puAlrt&&1==r&&(1==wppizza.opt.puAlrt&&(m?wppizzaPrettifyJsAlerts(wppizza.msg.pickup,"alert"):alert(wppizza.msg.pickup)),2==wppizza.opt.puAlrt&&!confirm(wppizza.msg.pickup)))return S(null,!(i&&o||!i&&o)),void S(!1,null);x(wppizza.funcBeforeCartRefr,e),_(),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"order-pickup",value:o,data:t,isCheckout:p}},function(e){return void 0!==wppizza.compat&&void 0!==wppizza.compat.puDel&&p?(window.location.reload(!0),void(c=!0)):(c=!1,void 0!==e.cart_markup&&(O(e.cart_markup),wppizza.shopOpen=e.is_open,v||setTimeout(k,10)),p&&void 0!==e.page_markup&&l("."+u+"-order-wrap").replaceWith(e.page_markup),l("."+u+"-orders-pickup-choice").replaceWith(e.cart_pickup_select),w=e.cart,void z("pickup-toggle"))},"json")}});var B=0,R=function(e){if(void 0!==wppizza.ofqc){var t="";p&&(t+="."+u+"-item-qupdate, ");var i,a,t=l(t+="."+u+"-cart-mod");if(t.spinner({min:0}),"load"==e&&0<o)return!1;t.focus(function(e){return e.preventDefault(),B=0,i=l(this).val(),spinner_element_id=l(this).attr("id").split("-").pop(-1),l(this).on("DOMMouseScroll mousewheel",function(e){return 0<e.originalEvent.detail||e.originalEvent.wheelDelta<0?0<parseInt(this.value)&&(this.value=parseInt(this.value,10)-1):this.value=parseInt(this.value,10)+1,!1}),!1}),t.keydown(function(e){if(a=l(this).val(),13==e.which||35==e.which)return l(this).blur(),!1}),t.blur(function(e){return a=l(this).val(),e.preventDefault(),e.stopPropagation(),0==B&&(i!=a&&l(this).change(),B++),!1})}};l(document).on("change","."+u+"-cart-mod, ."+u+"-item-qupdate",function(e){e.preventDefault(),e.stopPropagation();var t=l(this),e=t.attr("id").split("-").pop(-1),t=t.val();q(t,e)}),l(document).on("click","."+u+"-item-row > td > span > a.ui-spinner-up, ."+u+"-item-row > td > span > a.ui-spinner-down",function(e){e.preventDefault(),e.stopPropagation(),l(this).closest("span").find(".ui-spinner-input").blur()});var D=function(){p&&l("#"+f).validate({rules:wppizza.validate.rules,errorElement:"div",errorClass:"wppizza-validation-error error",ignore:":hidden, :disabled, ."+u+"-ignore, .ignore",errorPlacement:function(e,t){t=t.closest("div");e.appendTo(t)},invalidHandler:function(e,t){var i,a,o;t.numberOfInvalids()&&(i=l(t.errorList[0].element),t=(a=(o=l(window)).scrollTop())+o.height(),(o=i.offset().top)+i.height()<=t&&a<=o||l("html, body").animate({scrollTop:i.offset().top-50},300))},submitHandler:function(e,t){return l("#"+u+"-ordernow").attr("disabled","true"),_(),N(),!1}})};R("load");var Q,W,I,q=function(e,t,i){if(void 0!==i&&!0===i)return window.location.reload(!0),void(c=!0);void 0!==t&&(_(),i=l("."+u+"-totals-container"),_(i,"wppizza-loading-small"),i="",p&&(i=l("#"+u+"-send-order").serialize()),x(wppizza.funcBeforeCartRefr,"update"),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"update-order",id:t,quantity:e,isCheckout:p,data:i}},function(e){void 0!==e.invalid&&console.log(e.invalid),void 0!==e.cart_markup&&(O(e.cart_markup),wppizza.shopOpen=e.is_open,setTimeout(k,10)),void 0!==e.page_markup&&(l("."+u+"-order-wrap").replaceWith(e.page_markup),b()),w=e.cart,z("update-order")},"json"))};p&&(l("body").hasClass("wppizza-checkout")||l("body").addClass("wppizza-checkout"),D(),jQuery.extend(jQuery.validator.messages,{required:wppizza.validate.error.required,email:wppizza.validate.error.email,decimal:wppizza.validate.error.decimal}),l.validator.methods.decimal=function(e,t){return this.optional(t)||/^(?:\d+|\d{1,3}(?:[\s\.,]\d{3})+)(?:[\.,]\d+)?$/.test(e)},l(document).on("change","#ctips_pc",function(e){var t=0;void 0!==wppizzaCartJson.summary.total.total&&(t=wppizzaCartJson.summary.total.total),void 0!==wppizzaCartJson.summary.tips.tips&&0<t&&(t-=wppizzaCartJson.summary.tips.tips);var i=void 0!==wppizzaCartJson.currency.decimals?wppizzaCartJson.currency.decimals:2,t=(t=""==l(this).val()||0==l(this).val()?0:t*(l(this).val()/100)).toFixed(i);l("#ctips").val(t).trigger("blur")}),l(document).on("keyup","#ctips",function(e){var t;8==e.which||35<=e.which&&e.which<=40||(e=(t=l(this)).val(),validate=e.replace(/[^0-9\.,]+/g,""),t.val(validate))}),Q=l("#ctips"),W=l("#ctips_pc"),I=Q.val(),l(document).on("focus","#ctips",function(e){I=l(this).val(),0<W.length&&l("#ctips_pc").val("")}),l(document).on("keydown","#ctips",function(e){if(13==event.which||35==event.which)return event.preventDefault(),l(this).blur(),!1}),l(document).on("blur","#ctips",function(e){return F(I),!1}));function G(){var e=j(!1);""!=e&&(e="wppizza_"+e+"_init","function"==typeof(e=window[e])&&e())}var F=function(e){var t=l(this);e!=l("#ctips").val()&&(e=l("#"+u+"-send-order").serialize(),t.attr("disabled","true"),_(),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"addtips",data:e,isCheckout:p}},function(e){void 0!==e.cart_markup&&(O(e.cart_markup),wppizza.shopOpen=e.is_open,setTimeout(k,10)),p&&void 0!==e.page_markup&&(l("."+u+"-order-wrap").replaceWith(e.page_markup),b()),w=e.cart,z("tips")},"json"))};t&&(s||G());var N=function(){var t=document.getElementById(f),a=s;l("#"+t.id).hasClass("wppizza-order-confirmed")&&(a=!1);var o=!!l("#"+t.id).hasClass("wppizza-order-confirmed"),r=l(t).serialize();if(void 0!==wppizza.fnBeforeOrderSubmit&&0<wppizza.fnBeforeOrderSubmit.length){var n=c=!0,p=[];for(i=0;i<wppizza.fnBeforeOrderSubmit.length;i++){var e=new Function("formid, data, must_confirm, is_confirmation_page","return "+wppizza.fnBeforeOrderSubmit[i]+"(formid, data, must_confirm, is_confirmation_page);")(t.id,r,a,o);p.push(e)}l.when.apply(l,p).then(function(e){return l.each(p,function(e,t){if(void 0!==t.responseJSON._wppizza_verify_on_submit&&void 0!==t.responseJSON._wppizza_verify_on_submit.continue&&!1===t.responseJSON._wppizza_verify_on_submit.continue)return n=t.responseJSON._wppizza_verify_on_submit,!1}),n}).done(function(e){L(e,r,t,a,o)})}else L(!0,r,t,a,o)},L=function(a,o,r,n,p){var e;void 0===wppizza.fnVerifyOnOrderSubmit||!1===a?M(a,o,r,n,p):((e={}).post_data=o,jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"before_order_continue",param:e}},function(e){var t,i;void 0!==e.errors?(console.log("ERROR - OBOC"),console.log(e),t=!0,void 0===e.errors.func||""==e.errors.func||"function"==typeof(i=window[e.errors.func])&&(t=!1,i(e.errors.args)),wppizzaRestoreOrder(),t&&(e=e.errors.message,m?(e="<center>"+e.replace(/[\r\n]+/g,"<br>")+"</center>",wppizzaPrettifyJsAlerts(e,"interrupt before continue")):alert(e))):M(a,o,r,n,p)},"json"))};wppizzaGetCheckout=function(e){_();var t,i=l("#"+u+"-send-order").serialize();void 0!==e?(t=e.val(),g=j(t)):t=g,jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"changegateway",data:i,gateway_selected:t,isCheckout:p,pageReload:a}},function(e){return a?(window.location.reload(!0),void(c=!0)):(p&&void 0!==e.page_markup&&l("."+u+"-order-wrap").replaceWith(e.page_markup),l.each(wppizzaGatewayCss,function(e,t){l("#"+e).remove(),delete wppizzaGatewayCss[e]}),void 0!==e.gwAjax.styles&&l.each(e.gwAjax.styles,function(e,t){var i=e+"-css";wppizzaGatewayCss[i]=i;var a=t.src;if(""!=t.ver&&(a+="?ver="+t.ver),document.createStyleSheet)try{document.createStyleSheet(a)}catch(e){}else{e=document.createElement("link");e.rel="stylesheet",e.id=i,e.href=a,e.type="text/css",e.media="all",void 0!==t.deps&&""!=t.deps?l("#"+t.deps).after(e):l("head").append(e)}}),void 0!==e.gwAjax.inline&&l.each(e.gwAjax.inline,function(e,t){var i=e+"-js-extra",a=e+"-js",e="/* <![CDATA[ */";e+=t.data,e+="/* ]]> */",(t=document.createElement("script")).type="text/javascript",t.id=i,t.innerText=e,0<l("#"+i).length?l("#"+i).replaceWith(t):l("#"+a).before(t)}),l.each(wppizzaGatewayJs,function(e,t){l("#"+e).remove(),delete wppizzaGatewayJs[e]}),void 0!==e.gwAjax.scripts&&l.each(e.gwAjax.scripts,function(e,t){var i,a,o,r,n,p;void 0!==t.src&&""!=t.src&&(wppizzaGatewayJs[i=e+"-js"]=i,o=!0,(a=void 0!==t.data&&""!=t.data)&&(r=e+"-js-extra",p="/* <![CDATA[ */",p+=t.data,p+="/* ]]> */",(n=document.createElement("script")).type="text/javascript",n.id=r,n.innerText=p,0<l("#"+r).length&&(l("#"+r).replaceWith(n),o=!1)),e=t.src,void 0!==t.src&&""!=t.ver&&(e+="?ver="+t.ver),document.getElementById(i)&&l("#"+i).remove(),(p=document.createElement("script")).type="text/javascript",p.src=e,p.id=i,p.async=!0,void 0===t.deps||""==t.deps?(a&&o&&l("head").append(n),l("head").append(p)):a&&o?(l("#"+t.deps).after(n),l("#"+r).after(p)):l("#"+t.deps).after(p))}),wppizza.shopOpen=e.is_open,c=!1,w=e.cart,void z("change gateway"))},"json")};var M=function(e,t,i,a,o){var r=l("."+u+"-order-wrap");if(void 0===e||void 0===e.continue||!1!==e.continue){if(a)jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"confirmorder",data:t,isCheckout:p}},function(e){r.replaceWith(e.markup).promise().done(function(e){G()});e=l("#"+u+"-send-order").offset().top;l("html, body").animate({scrollTop:e-100},300),w=!1,b()},"json");else if(!a){var n=j(!1);if(""==n)return console.log("no payment method selected"),!1;if(n!=g)return console.log("payment method mismatch ["+n+"#"+g+"]"),!1;a="wppizza_"+n+"_payment";if("function"==typeof(a=window[a]))return"undefined"!=typeof event&&event.stopPropagation(),c=!0,a(i.id,t,event),!1;jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"submitorder",gateway_selected:n,wppizza_data:t}},function(e){if(void 0===e.error)return void 0!==e.output?(console.log(e),void r.replaceWith(e.output)):void 0!==e.gateway?void 0!==e.gateway.form?(c=!0,void l(e.gateway.form).appendTo("body").submit()):void 0!==e.gateway.redirect?(c=!0,void(window.location.href=e.gateway.redirect)):void 0:void 0!==e.redirect_url?(c=!0,void(window.location.href=e.redirect_url)):void(w=!1);var i=[],a=[];l.each(e.error,function(e,t){i[e]=t.error_id,a[e]=t.error_message});e='<div id="wppizza-order-error" class="wppizza-error">ERROR: '+i.join("|")+"<br /><br /></div>";return e+='<div id="wppizza-order-error-details" class="wppizza-error-details"><ul><li>'+a.join("</li><li>")+"</li></ul></div>",r.replaceWith(e),l("html,body").animate({scrollTop:0},300),void b()},"json")}}else{t=void 0!==e.alert&&""!=e.alert&&e.alert,e=void 0!==e.element_id&&""!=e.element_id&&e.element_id;if(!o)return!1!==t&&(m?(t="<center>"+t.replace(/[\r\n]+/g,"<br>")+"</center>",wppizzaPrettifyJsAlerts(t,"invalid")):alert(t)),!1!==e&&H(e),void wppizzaRestoreOrder();if(o){l("."+u+"-loading").addClass("wppizza-load-redirect").removeClass("wppizza-loading"),!1!==t&&alert(t);t=location.href.replace(location.hash,"");return!1!==e&&(t+="#"+e),window.location.href=t,void window.location.reload(!0)}}};l(document).on("change",'input[name="wppizza_gateway_selected"]:radio, select[name="wppizza_gateway_selected"]',function(e){wppizzaGetCheckout(l(this))});var H=function(e){!p||""!=(e=e||window.location.hash.substring(1))&&0<l("#"+e).length&&l("html, body").animate({scrollTop:l("#"+e).offset().top-100},1e3)};H(!1),l(document).on("change","."+u+"_account",function(e){l("#"+u+"-user-register-info").toggle(200)}),l(document).on("click","."+u+"-login-show, ."+u+"-login-cancel",function(e){e.preventDefault(),e.stopPropagation(),l("."+u+"-login-fieldset").slideToggle(300),l("."+u+"-login-option>a").toggle()}),e&&l("."+u+"-login-form > form ").validate({rules:{log:{required:!0},pwd:{required:!0}},errorElement:"div",errorClass:"wppizza-validation-error error",errorPlacement:function(e,t){t=t.closest("p");e.appendTo(t)}}),l(document).on("click","."+u+"-login-form #wp-submit",function(e){e.preventDefault(),e.stopPropagation();var t,i,a=l(this),o=a.closest("form");o.valid()&&(t=o.serialize(),e=a.css("width"),o=a.css("height"),i=l("."+u+"-login-info"),a.attr("disabled","true").val("").addClass("wppizza-wait").css({width:e,height:o}),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"user-login",data:t}},function(e){return void 0===e.error?(window.location.reload(!0),void(c=!0)):void 0!==e.error?(i.append(""+e.error).slideDown(250).delay(3500).slideUp(1e3,function(){i.empty()}),void a.removeAttr("disabled").val(e.button_value).removeClass("wppizza-wait")):void(w=!1)},"json"))}),l(document).on("click","."+u+"-transaction-details-orderhistory > legend",function(e){var t=l(this),i=t.closest("fieldset").find("."+u+"-order-details"),t=t.closest("fieldset").find("."+u+"-transaction-details");i.is(":visible")?(i.hide(),t.fadeIn()):(t.hide(),i.fadeIn())}),l(document).on("change","."+u+"-dd-categories > select",function(e){e.preventDefault(),e.stopPropagation();e=l(this).val();e<=0||(window.location.href=e)});var U=!0,V=null,$=function(e,t){var i;void 0!==wppizza.funcSetSts&&(!1===e?jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"loadcart",isCheckout:p}},function(e){var t=e.shop_status.next.remaining.sec;K(U,e,t,"A=>cache OFF"),U=!1},"json"):(i=e.shop_status.next.remaining.sec,K(U,e,i,"B=>cache on"),U=!1))};void 0===wppizza.usingCache&&$(!1,"debug1");var K=function(e,t,i,a){X(e,t,i),V=setInterval(function(){0==--i&&(clearInterval(V),setTimeout(function(){(void 0!==wppizza.isCheckout?wppizzaGetCheckout:wppizzaUpdateCart)()},1e3),setTimeout(function(){$(!1,"debug2")},3e3))},1e3)},X=function(e,t,a){if(void 0!==wppizza.funcSetSts){var o=wppizza.funcSetSts;if(0<o.length)for(i=0;i<o.length;i++)new Function("is_init, values, seconds_remaining","return "+o[i]+"(is_init, values, seconds_remaining);")(e,t,a);return!1}}});